 set.seed(12345)
 n=2^9
 sigma=0.5
 mu=c(rep(0.3,n/4), rep(3, n/4), rep(10, n/4), rep(0.3, n/4))
 x = rpois(n,exp(log(mu)+rnorm(n,sd=sigma)))
 fit = ebps(x)
 plot(x,col='grey80')
 lines(fit$posterior$mean_smooth)
 fit$sigma2
 plot(fit$elbo_trace)
 